(function(y){var z,A,j,k,l,q,g,r,s;function t(a){return function(c){return Object.prototype.toString.call(c)===a}}function B(a){var c=[],b;for(b=0;b<a.snapshotLength;b++)c.push(a.snapshotItem(b));return c}function F(a,c){var b="",e="",d="";c.r===j||c.r===k||(b+="g");c.i&&(b+="i");c.w&&(e="(^|\\P{L})",d="(\\P{L}|$)");return new XRegExp(e+(c.h?"("+a+")":a)+d,b)}function G(a,c){var b="",e="",d;a.w&&(b="$1");a.h&&(b+=r,e=s);a.w&&(e+="$3");d=o(c)?c:a.w?"$2":"$1";return b+d+e}function u(a,c,b,e){var a=
F(a,b),d=G(b,e),f={matchCount:0,nodes:[]},n,l=function(a){n++;b.w&&a.index--},g,h,m,i;for(g=0;g<c.length;g++){m=c[g];for(h=n=0;h<m.childNodes.length;h++)if(i=m.childNodes[h],i.nodeType===H&&XRegExp.forEach(i.data,a,l),(b.r===k||b.r===j)&&n>0)break;if(n>0){f.nodes.push(m);f.matchCount+=n;if(o(e)||b.h)m.innerHTML=m.innerHTML.replace(a,d);if(b.r===k||b.r===j)break}}return f}function C(a){return a!==null&&(D(HTMLElement)?a instanceof HTMLElement:typeof a==="object"&&a.nodeType===1&&o(a.nodeName))}function v(a,
c){var b;if(!o(a)||!(a!==""&&C(c)))throw b=Error("Search text and HTML element must be provided"),b.name="InvalidArgumentError",b;}function h(a){var c={},b;if(a!==null&&D(a))for(b in w)c[b]=b in a?a[b]:w[b];else if(a!==null&&typeof a==="undefined")c=w;else throw a=Error("Options must be an Object"),a.name="InvalidArgumentError",a;return c}function x(a,c,b){var e;e=b.i;var a=a.replace("'","&apos;"),d=[];d.push("descendant-or-self::*");d.push("[(not(self::script or self::style or self::head");d.push(" or self::meta or self::title or self::link");
d.push(" or self::select or self::option or self::optgroup");d.push(" or self::object or self::param or self::noscript");d.push(" or self::noframes or self::map or self::area");d.push(" or self::input or self::img or self::button or self::comment))");d.push(" and text()[contains(");e?(d.push('translate(., "'),d.push(z),d.push('","'),d.push(A),d.push('")')):d.push(".");d.push(',"');e?d.push(a.toLowerCase()):d.push(a);d.push('")]]');e=d.join("");a=null;switch(b.r){case l:a=XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE;
break;case j:a=!b.i||b.w?XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE:XPathResult.ANY_UNORDERED_NODE_TYPE;break;case k:a=!b.i||b.w?XPathResult.ORDERED_NODE_SNAPSHOT_TYPE:XPathResult.FIRST_ORDERED_NODE_TYPE;break;case q:a=XPathResult.ORDERED_NODE_SNAPSHOT_TYPE;break;case g:a=XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE;break;default:throw b=Error("Invalid return type"),b.name="InvalidArgumentError",b;}c=i.evaluate(e,c,null,a,null);nodes=null;switch(b.r){case l:case q:case g:c.snapshotLength>0&&(nodes=B(c));
break;case j:case k:!b.i||b.w?c.snapshotLength>0&&(nodes=B(c)):c.singleNodeValue!==null&&(nodes=[c.singleNodeValue])}return nodes}var i=y.document,p=t("[object Function]"),o=t("[object String]"),D=t("[object Object]");r='<span class="trouveur-highlight">';s="</span>";var E=i.head||i.getElementsByTagName("head")[0];l="c";k="fn";j="an";q="aon";g="aun";var w={i:!0,w:!1,h:!0,r:g};A="abcdefghijklmnopqrstuvwxyz";z="ABCDEFGHIJKLMNOPQRSTUVWXYZ";var I=new XRegExp(r+"((?:(?!</span>).)*)"+s,"gi"),H=3;if(!p(XRegExp))throw Error("Trouveur - This library requires XRegExp to work");
if(E)p=i.createElement("style"),p.innerHTML=".trouveur-highlight {background: yellow; color: black;}",E.appendChild(p);var f=function(){};f.version="0.9.3";f.count=function(a,c,b){var e=0;v(a,c);b=h(b);b.r=l;c=x(a,c,b);if(c!==null&&c.length>0)a=u(a,c,b),e=a.matchCount;return e};f.find=function(a,c,b){v(a,c);var b=h(b),e=x(a,c,b),c=[];if(e!==null&&e.length>0){if(!b.i||b.w||b.h)a=u(a,e,b),e=a.nodes;e.length>0&&(c=e)}return c};f.replace=function(a,c,b,e){v(a,b);if(typeof c!=="string")throw a=Error("Replacement text must be provided"),
a.name="InvalidArgumentError",a;var e=h(e),d=x(a,b,e),b=[];if(d!==null&&d.length>0)a=u(a,d,e,c),d=a.nodes,d.length>0&&(b=d);return b};f.highlight=function(a,c,b){b=h(b);b.h=!0;f.count(a,c,b)};f.unhighlight=function(a){var c;if(C(a))for(a=a.getElementsByClassName("trouveur-highlight");a.length>0;)c=a[0].parentNode,c.innerHTML=c.innerHTML.replace(I,"$1");else throw a=Error("An HTML element must be provided"),a.name="InvalidArgumentError",a;};y.Trouveur=f})(window);
